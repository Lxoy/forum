<div class="thread-page" *ngIf="currThread">

  <!-- THREAD HEADER -->
  <div class="thread-header">

    <!-- TOP ROW -->
    <div class="thread-top">

      <div class="left">
        <span class="category-badge">
          {{ currThread.category }}
        </span>
      </div>

      <div class="actions" *ngIf="isOwner && !isEditing">
        <button mat-icon-button (click)="startEdit()">
          <mat-icon>edit</mat-icon>
        </button>

        <button mat-icon-button color="warn" (click)="deleteThread()">
          <mat-icon>delete</mat-icon>
        </button>
      </div>

    </div>

    <!-- TITLE -->
    <div class="title-row">

      <h1 *ngIf="!isEditing" class="thread-title">
        {{ currThread.title }}
      </h1>

      <!-- EDIT MODE -->
      <div *ngIf="isEditing" class="edit-container">
        <input type="text" [(ngModel)]="editedTitle" class="edit-input" />

        <button mat-icon-button (click)="saveTitle()">
          <mat-icon>check</mat-icon>
        </button>

        <button mat-icon-button (click)="cancelEdit()">
          <mat-icon>close</mat-icon>
        </button>
      </div>

    </div>

    <!-- META -->
    <div class="thread-meta">
      <span class="author">
        {{ currThread.username }}
      </span>

      <span class="dot">â€¢</span>

      <span class="date">
        {{ currThread.createdAt | date:'dd.MM.yyyy' }}
      </span>
    </div>

  </div>

  <!-- POSTS -->
  <div class="posts" #postsContainer>

    <div class="post" *ngFor="let post of posts">

      <div class="post-header">
        <mat-icon class="avatar">account_circle</mat-icon>

        <div class="post-user">
          <span class="username">{{ post.username }}</span>
          <span class="post-date">
            {{ post.createdAt | date:'dd.MM.yyyy HH:mm' }}
          </span>
        </div>

        <div class="post-actions" *ngIf="isPostOwner(post.userId)">
          <button mat-icon-button (click)="startPostEdit(post)">
            <mat-icon>edit</mat-icon>
          </button>

          <button mat-icon-button color="warn" (click)="deletePost(post.id)">
            <mat-icon>delete</mat-icon>
          </button>
        </div>
      </div>

      <!-- NORMAL MODE -->
      <div *ngIf="editingPostId !== post.id" class="post-content">
        {{ post.content }}
      </div>

      <!-- EDIT MODE -->
      <div *ngIf="editingPostId === post.id" class="edit-post-container">
        <textarea [(ngModel)]="editedPostContent"></textarea>

        <div class="edit-buttons">
          <button mat-button color="primary" (click)="savePost(post.id)">
            Save
          </button>

          <button mat-button (click)="cancelPostEdit()">
            Cancel
          </button>
        </div>
      </div>

    </div>


    <div class="no-comments" *ngIf="posts.length === 1">
      Be the first to yap back.
    </div>

  </div>
</div>